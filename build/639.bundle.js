(self.webpackChunkplanet_pc=self.webpackChunkplanet_pc||[]).push([[639],{1071:(e,n,t)=>{"use strict";t.d(n,{Z:()=>o});var r=t(3645),a=t.n(r)()((function(e){return e[1]}));a.push([e.id,".LinkHeader {\n  position: fixed;\n  top: 0;\n  width: 100%;\n  padding: 20px 40px;\n  display: flex;\n  align-items: center;\n  background-color: black;\n}\n.LinkHeader-text {\n  color: white;\n}\n.LinkHeader-textLink {\n  cursor: pointer;\n}\n.LinkHeader-textLink:hover {\n  opacity: 0.9;\n}\n",""]);const o=a},4594:(e,n,t)=>{"use strict";t.d(n,{Z:()=>o});var r=t(3645),a=t.n(r)()((function(e){return e[1]}));a.push([e.id,"/*\n * @Author: liuxw@codoon.com \n * @Date: 2022-02-17 14:50:23 \n * @Last Modified by: liuxw@codoon.com\n * @Last Modified time: 2022-02-21 16:18:16\n */\n.SharedWorkerPage {\n  margin-top: 200px;\n}\n",""]);const o=a},5322:(e,n,t)=>{"use strict";t.d(n,{Z:()=>l});var r=t(7294),a=t(3379),o=t.n(a),i=t(1071);o()(i.Z,{insert:"head",singleton:!1}),i.Z.locals;var s="LinkHeader";const l=(0,r.memo)((function(e){var n=e.label,t=void 0===n?"本示例对应掘金链接：":n,a=e.url,o=(0,r.useCallback)((function(){window.open(a)}),[a]);return r.createElement("div",{className:s},r.createElement("div",{className:s+"-text"},t,r.createElement("span",{className:s+"-textLink",onClick:o},a)))}))},1639:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>l});var r=t(7294),a=t(5322),o=t(3379),i=t.n(o),s=t(4594);i()(s.Z,{insert:"head",singleton:!1}),s.Z.locals;const l=(0,r.memo)((function(e){var n=(0,r.useRef)(null),t=(0,r.useState)(0),o=t[0],i=t[1],s=(0,r.useCallback)((function(){n.current&&(n.current.port.postMessage("Close"),n.current=null)}),[]);return(0,r.useEffect)((function(){var e=new SharedWorker(""+window.location.origin+window.location.pathname+"sharedWorker/sharedWorker.js");return n.current=e,e.port.postMessage("Hello"),e.port.addEventListener("message",(function(e){console.log("主线程 接收到了 worker 消息："+e.data);var n=e.data;i(n)})),e.port.start(),window.addEventListener("beforeunload",s),function(){s(),window.removeEventListener("beforeunload",s)}}),[]),r.createElement(r.Fragment,null,r.createElement(a.Z,{url:"https://juejin.cn/post/7065609156446650381"}),r.createElement("div",{className:"SharedWorkerPage"},r.createElement("div",null,"试着打开一个新窗口，访问该页面"),r.createElement("div",null,"当前有 ",o," 个页面连接到了 shared worker")))}))}}]);